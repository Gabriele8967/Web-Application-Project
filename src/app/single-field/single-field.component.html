<div class="container mt-5">
  <div *ngIf="field.length > 0; else loading">
    <!-- Mostra l'immagine una sola volta, in alto al centro -->
    <div class="image-container text-center">
      <img [src]="field[0]?.image || 'default-field.jpg'" alt="Immagine del campo {{ field[0]?.name }}" class="img-fluid rounded">
    </div>

    <!-- Mostra i dettagli di ciascun campo -->
    <div *ngFor="let campo of field">
      <div class="row mt-4 field-details">
        <div class="col-md-8">
          <h2 class="field-name">{{ campo?.time }}:00</h2>
          <p><strong>ID del Campo:</strong> {{ campo?.id }}</p>
          <!-- Visualizza la data presa dall'URL -->
          <p><strong>Data:</strong> {{ dateFromUrl | date:'dd/MM/yyyy' }}</p>
          <p><strong>Stato:</strong> {{ campo?.isOccupied ? 'Occupato' : 'Libero' }}</p>
          <p *ngIf="campo?.idMaestro"><strong>ID Maestro:</strong> {{ campo?.idMaestro }}</p>

          <!-- Dettagli giocatori se il campo è occupato -->
          <div *ngIf="campo?.isOccupied">
            <h5>Giocatori:</h5>
            <p><strong>Giocatore 1:</strong>
              <a [routerLink]="['/users', campo?.idGiocatore1]" class="text-decoration-none">
                {{ campo?.idGiocatore1 }}
              </a>
            </p>
            <p><strong>Giocatore 2:</strong>
              <a [routerLink]="['/users', campo?.idGiocatore2]" class="text-decoration-none">
                {{ campo?.idGiocatore2 }}
              </a>
            </p>

            <!-- Pulsante per eliminare la prenotazione -->
            <button class="btn btn-danger mt-3" (click)="eliminaPrenotazione(campo.id, campo.date, campo.time)">Elimina Prenotazione</button>

            <!-- Pulsante per gestire la partita, solo se Giocatore 2 è 0 o nullo -->
            <button *ngIf="campo?.idGiocatore2 === 0 || campo?.idGiocatore2 === null"
                    class="btn btn-warning mt-3"
                    (click)="gestisciPartita(campo)">
              Gestisci Partita
            </button>
          </div>

          <!-- Pulsante per prenotare se il campo è libero -->
          <div *ngIf="!campo?.isOccupied">
            <button class="btn btn-primary mt-3" (click)="goToBookingPage(campo)">Prenota Campo</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Template di caricamento -->
  <ng-template #loading>
    <p>Caricamento campo...</p>
  </ng-template>
</div>
